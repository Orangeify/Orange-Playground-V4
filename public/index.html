<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Orange Playground - Home</title>
    <link rel="stylesheet" href="assets/css/styles.css">
    <script>
        // Wait for the window to load
        window.addEventListener('load', () => {
            document.querySelector('.loader').classList.add('loader--hidden');
        });
    </script>
    <script src="assets/js/loader-message.js" defer></script>
    <script src="assets/js/particles.js" defer></script>
    <script>
        particlesJS.load('assets/js/particles.js', 'assets/particles.json', function() {
            console.log('callback - particles.js config loaded');
        });
    </script>
</head>
<body>
<iframe id="frame" class="dnone"></iframe>
<div class="loader">
    <div id="message" class="loader-message">Loading...</div>
</div>
    <div class="page-content home-page">
        <div class="home-center">
            <div class="partitcles"></div>
            <div class="playground-logo"></div>
            <h1 class="home-title">Orange Playground</h1>
        </div>
        <div class="group">
          <svg viewBox="0 0 24 24" aria-hidden="true" class="search-icon">
            <g>
              <path
                d="M21.53 20.47l-3.66-3.66C19.195 15.24 20 13.214 20 11c0-4.97-4.03-9-9-9s-9 4.03-9 9 4.03 9 9 9c2.215 0 4.24-.804 5.808-2.13l3.66 3.66c.147.146.34.22.53.22s.385-.073.53-.22c.295-.293.295-.767.002-1.06zM3.5 11c0-4.135 3.365-7.5 7.5-7.5s7.5 3.365 7.5 7.5-3.365 7.5-7.5 7.5-7.5-3.365-7.5-7.5z"
              ></path>
            </g>
          </svg>

          <input
            id="address"
            class="input"
            type="text"
            placeholder="Search..."
            name="searchbar"
          />
        </div>
    </div>

    <nav class="bottom-nav">
        <div class="nav-container">
            <a href="index.html" class="nav-item nav-home active">
            <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                <polyline points="9 22 9 12 15 12 15 22"></polyline>
            </svg>
                <span class="nav-label">Home</span>
        </a>
        
        <div class="nav-right">
            <a href="index.html" class="nav-item">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-gamepad2-icon lucide-gamepad-2"><line x1="6" x2="10" y1="11" y2="11"/><line x1="8" x2="8" y1="9" y2="13"/><line x1="15" x2="15.01" y1="12" y2="12"/><line x1="18" x2="18.01" y1="10" y2="10"/><path d="M17.32 5H6.68a4 4 0 0 0-3.978 3.59c-.006.052-.01.101-.017.152C2.604 9.416 2 14.456 2 16a3 3 0 0 0 3 3c1 0 1.5-.5 2-1l1.414-1.414A2 2 0 0 1 9.828 16h4.344a2 2 0 0 1 1.414.586L17 18c.5.5 1 1 2 1a3 3 0 0 0 3-3c0-1.545-.604-6.584-.685-7.258-.007-.05-.011-.1-.017-.151A4 4 0 0 0 17.32 5z"/></svg>
            </a>
            
            <a href="index.html" class="nav-item">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-layout-grid-icon lucide-layout-grid"><rect width="7" height="7" x="3" y="3" rx="1"/><rect width="7" height="7" x="14" y="3" rx="1"/><rect width="7" height="7" x="14" y="14" rx="1"/><rect width="7" height="7" x="3" y="14" rx="1"/></svg>
            </a>
            
            <a href="index.html" class="nav-item">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-settings-icon lucide-settings"><path d="M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915"/><circle cx="12" cy="12" r="3"/></svg>
            </a>
        </div>
        </div>
    </nav>
    <head>
        <!-- The UV bundle. It contains most of the code for ultraviolet to function properly -->
        <script src="uv/uv.bundle.js" defer></script>
        <!-- The uv.config.js file we just made. -->
        <script src="uv/uv.config.js" defer></script>
        <!-- BareMux content -->
        <script src="baremux/index.js" defer></script>
        <iframe id="frame" class="dnone"></iframe>
    </head>
    <body>
        <script>
            async function regSW() {
                //if the service worker doesn't exist throw an error
                if (!navigator.serviceWorker) {
                    throw new Error("Your browser doesn't support service workers.");
                }
                //register the service worker. (We just made that file!)
                await navigator.serviceWorker.register("/sw.js");
            }
            regSW();
            //function for ease of use
            async function setTransport() {
                //create a new bare mux connection
                const conn = new BareMux.BareMuxConnection("/baremux/worker.js");
                //If you are using http:// change it to ws:// or if using https:// change it to wss://, get the domain name and add "/wisp/" to the end of it
                const wispUrl = (location.protocol === "https:" ? "wss://" : "ws://") + location.host + "/wisp/";
                //actually set the transport!!
                await conn.setTransport("/epoxy/index.mjs", [{ wisp: wispUrl /* We just set this url! */ }]);
            }
            //new function, pass in the url so we can actually proxy it!
            async function proxy(url) {
                //get the iframe!
                const iframe = document.getElementById("frame");
                //create the initial url with ultraviolet
                const uvUrl = __uv$config.prefix /* The prefix set in the config */ + __uv$config.encodeUrl(/* Our search function! */ search(url, "https://www.google.com/search?q=%s" /* the search engine template. Feel free to change it to whatever search engine you want (just make sure to add %s add the end!) */)) /* Encode the url with XOR */
                //call our setTransport function
                await setTransport();
                //remove the "dnone" class so the iframe is visible.
                iframe.classList.remove("dnone");
                //set the iframe's source to the initial url
                iframe.src = uvUrl;
            }
            //listen for keypresses in the address bar
            document.getElementById("address").addEventListener("keypress", function (event) {
                //if it's the enter key, proxy the url!
                if (event.key === "Enter") {
                    //call our proxy function with the url they entered
                    proxy(document.getElementById("address").value /* The value the user has entered */)
                }
            });
            //new function to allow a user to be able to search intead of having to type in a full url
            function search(key /* the user's value */, template /* the search engine template to use */) {
                try {
                    //if the entered a full url! Continue on
                    return new URL(key).toString();
                } catch (error) { /* ignore errors */ }
                try {
                    //if the entered value is a full URL when adding http:// or https:// in front of it, add http:// and the continue.
                    const url = new URL(`http://${key}`);
                    //we also have to make sure it is an actual domain!
                    if (url.hostname.includes('.')) return url.toString();
                } catch (error) { /* Ignore the errors */ }
                //if the above doesn't pass, add the entered value to a search template and the continue.
                return template.replace("%s", encodeURIComponent(key));
            }
        </script>
    </body>

</html>
